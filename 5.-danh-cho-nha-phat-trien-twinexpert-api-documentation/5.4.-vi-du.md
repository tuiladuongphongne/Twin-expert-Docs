---
description: Các ví dụ code thực tế để bắt đầu nhanh
---

# 5.4. Ví dụ

### 1. Lấy danh sách AI Twins

Xem tất cả AI twins mà bạn có thể truy cập

<mark style="background-color:green;">GET</mark>`/api/v1/twins`

<details>

<summary><strong>Thử nghiệm API</strong></summary>

API Key

```
123456
```

{% hint style="info" %}
Kết quả
{% endhint %}

```
{
  "statusCode": 401,
  "timestamp": "2025-07-23T17:06:03.675Z",
  "path": "/api/v1/twins",
  "method": "GET",
  "message": "Invalid API key format",
  "error": "Unauthorized"
}
```

</details>

#### <> Ví dụ code

Lấy danh sách twins có thể truy cập

{% tabs %}
{% tab title="JavaScript" %}
```javascript
// Lấy danh sách twins
const response = await fetch('https://api.twinexpert.com/api/v1/twins', {
  headers: {
    'Authorization': 'Bearer 123456',
    'Content-Type': 'application/json'
  }
});

const twins = await response.json();
console.log('Available twins:', twins.data);
```
{% endtab %}

{% tab title="Python" %}
```python
import requests

# Lấy danh sách twins
headers = {
    'Authorization': 'Bearer 123456',
    'Content-Type': 'application/json'
}

response = requests.get(
    'https://api.twinexpert.com/api/v1/twins',
    headers=headers
)

twins = response.json()['data']
print(f'Found {len(twins)} twins')
```
{% endtab %}

{% tab title="cURL" %}
```ruby
# Lấy danh sách twins
curl -X GET "https://api.twinexpert.com/api/v1/twins" \
  -H "Authorization: Bearer 123456" \
  -H "Content-Type: application/json"
```
{% endtab %}
{% endtabs %}

### 2. Chat với AI Twin

Tạo cuộc trò chuyện và gửi tin nhắn đến AI twin

<mark style="background-color:green;">GET</mark>     <mark style="background-color:$success;">/api/v1/conversations</mark>

#### <> Ví dụ code

Tạo cuộc trò chuyện và gửi tin nhắn đến AI twin

{% tabs %}
{% tab title="JavaScript" %}
```javascript
// Tạo cuộc trò chuyện và gửi tin nhắn
async function chatWithTwin(twinId, message) {
  // 1. Tạo cuộc trò chuyện mới
  const conversationResponse = await fetch('https://api.twinexpert.com/api/v1/conversations', {
    method: 'POST',
    headers: {
      'Authorization': 'Bearer YOUR_API_KEY',
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      twinId: twinId,
      title: 'API Chat Session'
    })
  });
  
  const conversation = await conversationResponse.json();
  const conversationId = conversation.data.id;
  
  // 2. Gửi tin nhắn
  const messageResponse = await fetch(`${process.env.NEXT_PUBLIC_API_URL}/api/v1/conversations/${conversationId}/messages`, {
    method: 'POST',
    headers: {
      'Authorization': 'Bearer YOUR_API_KEY',
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      content: message
    })
  });
  
  const result = await messageResponse.json();
  return result.data;
}

// Sử dụng
chatWithTwin('twin-id', 'Xin chào!').then(result => {
  console.log('Response:', result);
});
```
{% endtab %}

{% tab title="Python" %}
```python
import requests

class TwinExpertAPI:
    def __init__(self, api_key):
        self.api_key = api_key
        self.base_url = 'https://api.twinexpert.com/api/v1'
        self.headers = {
            'Authorization': f'Bearer {api_key}',
            'Content-Type': 'application/json'
        }
    
    def create_conversation(self, twin_id, title="API Chat"):
        response = requests.post(
            f'{self.base_url}/conversations',
            headers=self.headers,
            json={'twinId': twin_id, 'title': title}
        )
        return response.json()['data']
    
    def send_message(self, conversation_id, message):
        response = requests.post(
            f'{self.base_url}/conversations/{conversation_id}/messages',
            headers=self.headers,
            json={'content': message}
        )
        return response.json()['data']
    
    def chat_with_twin(self, twin_id, message):
        # Tạo cuộc trò chuyện
        conversation = self.create_conversation(twin_id)
        
        # Gửi tin nhắn
        result = self.send_message(conversation['id'], message)
        return result

# Sử dụng
api = TwinExpertAPI('YOUR_API_KEY')
response = api.chat_with_twin('twin-id', 'Xin chào!')
print(response)
```
{% endtab %}

{% tab title="cURL" %}
```ruby
# 1. Tạo cuộc trò chuyện mới
curl -X POST "https://api.twinexpert.com/api/v1/conversations" \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "twinId": "twin-id",
    "title": "API Chat Session"
  }'

# 2. Gửi tin nhắn (với conversation ID từ response trên)
curl -X POST "https://api.twinexpert.com/api/v1/conversations/CONVERSATION_ID/messages" \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "content": "Xin chào!"
  }'
```
{% endtab %}
{% endtabs %}

### 2. Streaming Chat

Nhận phản hồi real-time bằng Server-Sent Events

> <i class="fa-lightbulb-on">:lightbulb-on:</i> **Streaming Response**
>
> Endpoint streaming trả về Server-Sent Events với các event types:
>
> * `progress`: Thông tin tiến trình
> * `delta`: Từng phần của response
> * `complete`: Hoàn thành message
> * `error`: Lỗi xảy ra
